<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chargement - GameHub</title>
    
    <!-- PWA Configuration -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#8A2BE2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="GameHub">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/icon-16x16.png">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #8A2BE2;
            --primary-dark: #6A1BB2;
            --secondary: #FF6B6B;
            --accent: #00D4FF;
            --dark: #1A1A2E;
            --light: #F8F9FA;
            --success: #28A745;
            --warning: #FFC107;
            --transition: all 0.3s ease;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #1A1A2E 0%, #16213E 50%, #0F3460 100%);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            -webkit-tap-highlight-color: transparent;
            padding: 20px;
        }

        .loading-container {
            text-align: center;
            max-width: 450px;
            padding: 30px;
            background: rgba(26, 26, 46, 0.8);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(138, 43, 226, 0.3);
            position: relative;
            z-index: 10;
        }

        /* Logo animation */
        .logo-wrapper {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 0 auto 30px;
        }

        .logo-circle {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 3px solid transparent;
            animation: rotate 3s linear infinite;
        }

        .logo-circle:nth-child(1) {
            border-top-color: var(--primary);
            animation-delay: 0.1s;
        }

        .logo-circle:nth-child(2) {
            border-right-color: var(--accent);
            animation-delay: 0.2s;
            animation-direction: reverse;
        }

        .logo-circle:nth-child(3) {
            border-bottom-color: var(--secondary);
            animation-delay: 0.3s;
            animation-duration: 2.5s;
        }

        .logo-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: white;
            box-shadow: 0 0 30px rgba(138, 43, 226, 0.5);
            z-index: 2;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .logo-center:hover {
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow: 0 0 40px rgba(138, 43, 226, 0.7);
        }

        /* Pulsating dots */
        .dots-container {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin: 30px 0;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--accent);
            animation: pulse 1.5s ease-in-out infinite;
        }

        .dot:nth-child(2) {
            animation-delay: 0.2s;
            background: var(--primary);
        }

        .dot:nth-child(3) {
            animation-delay: 0.4s;
            background: var(--secondary);
        }

        /* Text animation */
        .loading-text {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(to right, var(--primary), var(--accent), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-size: 200% 200%;
            animation: gradientShift 3s ease infinite;
            transition: opacity 0.3s ease;
        }

        .loading-subtext {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.95rem;
            margin-top: 5px;
            transition: opacity 0.3s ease;
            min-height: 20px;
        }

        /* Progress bar */
        .progress-container {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin: 25px 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, var(--primary), var(--accent));
            border-radius: 10px;
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Stats preview */
        .stats-preview {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 30px;
            opacity: 0;
            animation: fadeIn 0.5s ease 1s forwards;
        }

        .stat-preview {
            text-align: center;
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            min-width: 80px;
        }

        .stat-preview-value {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--accent);
            margin-bottom: 5px;
        }

        .stat-preview-label {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Particles background */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            border-radius: 50%;
            background: var(--accent);
            opacity: 0.3;
            animation: float 15s infinite linear;
        }

        .particle:nth-child(odd) {
            background: var(--primary);
        }

        .particle:nth-child(even) {
            background: var(--secondary);
        }

        /* Action Buttons Container */
        .actions-container {
            margin-top: 30px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }

        .actions-container.show {
            opacity: 1;
            transform: translateY(0);
        }

        /* Continue Button */
        .continue-button {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border: none;
            border-radius: 50px;
            padding: 16px 40px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(138, 43, 226, 0.4);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 10px auto;
            min-width: 250px;
        }

        .continue-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(138, 43, 226, 0.6);
        }

        .continue-button i {
            font-size: 18px;
        }

        /* Install Button */
        .install-button {
            background: rgba(255, 255, 255, 0.1);
            color: var(--accent);
            border: 2px solid var(--accent);
            border-radius: 50px;
            padding: 14px 30px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 5px auto;
            min-width: 250px;
            backdrop-filter: blur(10px);
        }

        .install-button:hover {
            background: var(--accent);
            color: var(--dark);
            transform: translateY(-3px);
        }

        .install-button i {
            font-size: 16px;
        }

        /* Install Instructions */
        .install-instructions {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 15px;
            margin-top: 20px;
            border-left: 4px solid var(--accent);
            text-align: left;
            display: none;
        }

        .install-instructions.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .install-instructions h4 {
            color: var(--accent);
            margin-bottom: 10px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .install-instructions p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 12px;
            margin: 5px 0;
            line-height: 1.4;
        }

        /* Animation pour le bouton install */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-2px); }
            20%, 40%, 60%, 80% { transform: translateX(2px); }
        }

        .shake {
            animation: shake 0.5s ease;
        }

        /* Animations */
        @keyframes rotate {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.7;
            }
        }

        @keyframes gradientShift {
            0%, 100% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.5;
            }
            90% {
                opacity: 0.5;
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }

        /* Responsive */
        @media (max-width: 480px) {
            .loading-container {
                max-width: 95%;
                padding: 20px;
            }

            .logo-wrapper {
                width: 100px;
                height: 100px;
            }

            .logo-center {
                width: 60px;
                height: 60px;
                font-size: 24px;
            }

            .loading-text {
                font-size: 1.3rem;
            }

            .stats-preview {
                gap: 15px;
            }

            .stat-preview {
                padding: 8px 10px;
                min-width: 70px;
            }

            .continue-button, .install-button {
                min-width: 200px;
                padding: 14px 25px;
            }
        }

        /* GameHub branding */
        .gamehub-brand {
            position: fixed;
            bottom: 20px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.5);
            animation: fadeIn 0.5s ease 1.5s forwards;
            opacity: 0;
            z-index: 10;
        }

        .gamehub-brand span {
            color: var(--accent);
            font-weight: 600;
        }
    </style>
</head>
<body>
    <!-- Particles background -->
    <div class="particles" id="particles"></div>

    <div class="loading-container" id="loadingContainer">
        <!-- Animated logo -->
        <div class="logo-wrapper">
            <div class="logo-circle"></div>
            <div class="logo-circle"></div>
            <div class="logo-circle"></div>
            <div class="logo-center" id="logoCenter">
                <i class="fas fa-dice"></i>
            </div>
        </div>

        <!-- Loading text -->
        <div class="loading-text" id="loadingText">Chargement GameHub</div>
        <div class="loading-subtext" id="loadingSubtext">Pr√©paration de votre exp√©rience gaming ultime</div>

        <!-- Animated dots -->
        <div class="dots-container">
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
        </div>

        <!-- Progress bar -->
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>

        <!-- Stats preview -->
        <div class="stats-preview">
            <div class="stat-preview">
                <div class="stat-preview-value">10+</div>
                <div class="stat-preview-label">Jeux</div>
            </div>
            <div class="stat-preview">
                <div class="stat-preview-value">30%</div>
                <div class="stat-preview-label">Commission</div>
            </div>
            <div class="stat-preview">
                <div class="stat-preview-value">‚àû</div>
                <div class="stat-preview-label">Gains</div>
            </div>
        </div>

        <!-- Action Buttons (hidden initially) -->
        <div class="actions-container" id="actionsContainer">
            <button class="continue-button" id="continueButton">
                <i class="fas fa-play"></i> Acc√©der √† GameHub
            </button>
            
            <button class="install-button" id="installButton">
                <i class="fas fa-download"></i> Installer l'Application
            </button>
            
            <div class="install-instructions" id="installInstructions">
                <h4><i class="fas fa-info-circle"></i> Comment installer :</h4>
                <p><strong>Android/Chrome :</strong> Menu (‚ãÆ) ‚Üí "Installer l'application"</p>
                <p><strong>iOS/Safari :</strong> Partager (‚éô) ‚Üí "Sur l'√©cran d'accueil"</p>
            </div>
        </div>
    </div>

    <!-- Branding -->
    <div class="gamehub-brand">
        Plateforme gaming premium ‚Ä¢ <span>GameHub v2.1.0</span>
    </div>

    <script>
        // Variables globales - D√âBUT ABSOLU
        let deferredPrompt = null;
        let loadingComplete = false;
        let progressInterval;

        // 1Ô∏è‚É£ CAPTURE IMM√âDIATE du beforeinstallprompt
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('‚úÖ √âv√©nement beforeinstallprompt CAPTUR√â IMM√âDIATEMENT');
            e.preventDefault();
            deferredPrompt = e;
            
            // Optionnel : montre le bouton tout de suite
            const installButton = document.getElementById('installButton');
            if (installButton) {
                installButton.style.display = 'flex';
                installButton.innerHTML = '<i class="fas fa-download"></i> Installer l\'App (Gratuit)';
            }
        });

        // Cr√©er des particules anim√©es
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 20;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                const size = Math.random() * 15 + 5;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.left = `${Math.random() * 100}%`;
                
                const duration = Math.random() * 20 + 10;
                const delay = Math.random() * 5;
                particle.style.animationDuration = `${duration}s`;
                particle.style.animationDelay = `${delay}s`;
                
                particlesContainer.appendChild(particle);
            }
        }

        // Simuler un chargement progressif
        function simulateLoading() {
            const progressBar = document.getElementById('progressBar');
            const actionsContainer = document.getElementById('actionsContainer');
            
            const texts = [
                {main: "Chargement GameHub", sub: "Pr√©paration de votre exp√©rience gaming ultime"},
                {main: "Initialisation des bots", sub: "Optimisation en cours..."},
                {main: "Pr√©paration des jeux", sub: "Chargement des ressources..."},
                {main: "Optimisation des gains", sub: "Configuration des param√®tres..."},
                {main: "Chargement termin√© !", sub: "Pr√™t √† g√©n√©rer des gains !"}
            ];

            let progress = 0;
            const totalTime = 4000;
            const intervalTime = 30;
            const steps = totalTime / intervalTime;
            const increment = 100 / steps;
            
            let textIndex = 0;
            
            progressInterval = setInterval(() => {
                progress += increment;
                progressBar.style.width = `${Math.min(progress, 100)}%`;
                
                // Changer le texte √† certains pourcentages
                if (progress >= 20 && progress < 40 && textIndex < 1) {
                    textIndex = 1;
                    updateLoadingText(texts[1]);
                } else if (progress >= 40 && progress < 60 && textIndex < 2) {
                    textIndex = 2;
                    updateLoadingText(texts[2]);
                } else if (progress >= 60 && progress < 80 && textIndex < 3) {
                    textIndex = 3;
                    updateLoadingText(texts[3]);
                } else if (progress >= 100 && textIndex < 4) {
                    textIndex = 4;
                    completeLoading();
                }
            }, intervalTime);
        }

        // Mettre √† jour le texte de chargement
        function updateLoadingText(text) {
            const loadingText = document.getElementById('loadingText');
            const loadingSubtext = document.getElementById('loadingSubtext');
            
            loadingText.style.opacity = 0;
            loadingSubtext.style.opacity = 0;
            
            setTimeout(() => {
                loadingText.textContent = text.main;
                loadingSubtext.textContent = text.sub;
                loadingText.style.opacity = 1;
                loadingSubtext.style.opacity = 1;
            }, 300);
        }

        // Terminer le chargement
        function completeLoading() {
            clearInterval(progressInterval);
            loadingComplete = true;
            
            const progressBar = document.getElementById('progressBar');
            const actionsContainer = document.getElementById('actionsContainer');
            const loadingText = document.getElementById('loadingText');
            const loadingSubtext = document.getElementById('loadingSubtext');
            
            // Mettre √† jour le texte final
            loadingText.textContent = "Pr√™t √† jouer !";
            loadingSubtext.textContent = "GameHub est pr√™t √† vous faire gagner";
            
            // Animation de la barre de progression termin√©e
            progressBar.style.background = "linear-gradient(to right, #28A745, #00FF88)";
            
            // Afficher les boutons d'action
            setTimeout(() => {
                actionsContainer.classList.add('show');
                updateInstallButtonUI(); // Mettre √† jour l'interface d'installation
            }, 500);
            
            // Petite animation de c√©l√©bration
            celebrateCompletion();
        }

        // Mettre √† jour l'interface du bouton d'installation
        function updateInstallButtonUI() {
            const installButton = document.getElementById('installButton');
            const installInstructions = document.getElementById('installInstructions');
            const isStandalone = window.matchMedia('(display-mode: standalone)').matches || 
                                 window.navigator.standalone;
            
            // Si d√©j√† install√©
            if (isStandalone) {
                installButton.style.display = 'none';
                installInstructions.classList.add('show');
                installInstructions.innerHTML = '<h4><i class="fas fa-check-circle"></i> Application d√©j√† install√©e</h4><p>GameHub est install√© sur votre appareil !</p>';
                return;
            }
            
            // Si l'installation native est disponible
            if (deferredPrompt) {
                installButton.innerHTML = '<i class="fas fa-download"></i> Installer l\'App (Gratuit)';
                installButton.style.display = 'flex';
                installInstructions.classList.remove('show');
            } else {
                // Sinon, montrer les instructions manuelles
                installButton.innerHTML = '<i class="fas fa-mobile-alt"></i> Ajouter √† l\'√©cran d\'accueil';
                installButton.style.display = 'flex';
                installInstructions.classList.add('show');
            }
        }

        // G√©rer le clic sur le bouton d'installation - VERSION SIMPLIFI√âE
        async function handleInstallClick() {
            console.log('üñ±Ô∏è Clic sur le bouton d\'installation');
            
            if (deferredPrompt) {
                console.log('üöÄ Lancement de l\'installation native...');
                
                try {
                    deferredPrompt.prompt();
                    const choiceResult = await deferredPrompt.userChoice;
                    
                    if (choiceResult.outcome === 'accepted') {
                        console.log('‚úÖ Utilisateur a accept√© l\'installation');
                        
                        const installButton = document.getElementById('installButton');
                        const installInstructions = document.getElementById('installInstructions');
                        
                        installButton.innerHTML = '<i class="fas fa-check"></i> Installation r√©ussie !';
                        installButton.style.background = '#28A745';
                        installButton.style.borderColor = '#28A745';
                        installButton.disabled = true;
                        installInstructions.style.display = 'none';
                    } else {
                        console.log('‚ùå Utilisateur a refus√© l\'installation');
                        const installButton = document.getElementById('installButton');
                        installButton.classList.add('shake');
                        setTimeout(() => installButton.classList.remove('shake'), 500);
                    }
                    
                    deferredPrompt = null;
                } catch (error) {
                    console.error('Erreur lors de l\'installation:', error);
                }
            } else {
                console.log('‚ÑπÔ∏è Installation native non disponible');
                const installInstructions = document.getElementById('installInstructions');
                installInstructions.classList.add('show');
                
                const installButton = document.getElementById('installButton');
                installButton.classList.add('shake');
                setTimeout(() => installButton.classList.remove('shake'), 500);
            }
        }

        // Animation de c√©l√©bration
        function celebrateCompletion() {
            const logoCenter = document.getElementById('logoCenter');
            logoCenter.style.animation = "pulse 1s ease 3";
            
            for (let i = 0; i < 10; i++) {
                setTimeout(() => {
                    createCelebrationParticle();
                }, i * 100);
            }
        }

        // Cr√©er une particule de c√©l√©bration
        function createCelebrationParticle() {
            const particlesContainer = document.getElementById('particles');
            const logoCenter = document.getElementById('logoCenter');
            const rect = logoCenter.getBoundingClientRect();
            
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.width = '8px';
            particle.style.height = '8px';
            particle.style.left = `${rect.left + rect.width/2}px`;
            particle.style.top = `${rect.top + rect.height/2}px`;
            particle.style.background = Math.random() > 0.5 ? 'var(--primary)' : 'var(--accent)';
            particle.style.animation = 'float 3s ease-out forwards';
            
            particlesContainer.appendChild(particle);
            
            setTimeout(() => {
                if (particle.parentNode) {
                    particle.parentNode.removeChild(particle);
                }
            }, 3000);
        }

        // Enregistrement du Service Worker
        function registerServiceWorker() {
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('./service-worker.js')
                        .then(registration => {
                            console.log('‚úÖ Service Worker enregistr√©:', registration.scope);
                        })
                        .catch(error => {
                            console.log('‚ùå Erreur Service Worker:', error);
                        });
                });
            }
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Initialisation de GameHub...');
            console.log('üì± Mode standalone?', window.matchMedia('(display-mode: standalone)').matches);
            
            createParticles();
            registerServiceWorker();
            
            // D√©marrer le chargement
            simulateLoading();
            
            // Clic sur le bouton continuer
            document.getElementById('continueButton').addEventListener('click', function() {
                if (!loadingComplete) return;
                
                const loadingContainer = document.getElementById('loadingContainer');
                loadingContainer.style.opacity = '0';
                loadingContainer.style.transform = 'translateY(-20px)';
                
                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 500);
            });
            
            // Clic sur le bouton d'installation
            document.getElementById('installButton').addEventListener('click', handleInstallClick);
            
            // Clic sur le logo
            document.getElementById('logoCenter').addEventListener('click', function() {
                if (loadingComplete) {
                    createCelebrationParticle();
                }
            });
            
            // Touche Entr√©e pour continuer
            document.addEventListener('keydown', function(e) {
                if (e.code === 'Enter' && loadingComplete) {
                    document.getElementById('continueButton').click();
                }
            });
            
            // Log apr√®s 2 secondes pour v√©rification
            setTimeout(() => {
                console.log('üîç √âtat PWA:', {
                    deferredPrompt: !!deferredPrompt,
                    loadingComplete: loadingComplete,
                    isStandalone: window.matchMedia('(display-mode: standalone)').matches
                });
            }, 2000);
        });
    </script>
</body>
</html>